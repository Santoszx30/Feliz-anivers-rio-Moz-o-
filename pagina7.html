<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>P√°gina 7 ‚ôüÔ∏è</title>
<style>
body {
  margin: 0;
  height: 100vh;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  background: radial-gradient(circle at top, #3b0a57, #12001a);
  font-family: Arial, sans-serif;
}

#title {
  color: #fff;
  font-size: 1.5rem;
  margin-bottom: 10px;
  text-align: center;
}

#board {
  display: grid;
  grid-template-columns: repeat(8, 1fr);
  grid-template-rows: repeat(8, 1fr);
  width: 90vmin;
  height: 90vmin;
  border: 5px solid #a855f7;
  box-shadow: 0 0 25px #a855f7;
  position: relative;
  pointer-events: auto;
  transition: transform 1s ease;
}

.cell { width: 100%; height: 100%; }
.light { background: #1a1a1a; }
.dark  { background: #0b0b0b; }

.piece {
  width: 80%; height: 80%;
  border-radius: 50%;
  margin: auto;
  margin-top: 10%;
}

.player { background: #9333ea; }
.ai     { background: #dc2626; }
.king   { border: 3px solid gold; }

.highlight { outline: 3px solid #22c55e; }

.capture-effect {
  position: fixed;
  top: 50%; left: 50%;
  width: 60vmin; height: 60vmin;
  margin-left: -30vmin; margin-top: -30vmin;
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  pointer-events: none;
  opacity: 0;
  transform: scale(0);
  animation: capturePop 0.7s forwards;
  z-index: 2000;
}

.capture-effect img {
  width: 100%; height: auto; 
  max-height: 80%;
  object-fit: contain;
  border-radius: 12px;
  opacity: 0;
  animation: fadeIn 0.5s forwards 0.2s;
}

.capture-effect p {
  color: white;
  text-align: center;
  padding: 10px;
  font-size: 4vmin;
  font-weight: bold;
  opacity: 0;
  animation: fadeIn 0.5s forwards 0.5s;
}

@keyframes fadeIn { to { opacity: 1; } }
@keyframes capturePop {
  0% { transform: scale(0) rotate(-20deg); opacity: 0; }
  50% { transform: scale(1.1) rotate(10deg); opacity: 1; }
  70% { transform: scale(0.95) rotate(-5deg); opacity: 1; }
  100% { transform: scale(1) rotate(0deg); opacity: 1; }
}

#finalEffect {
  position: fixed;
  top: 50%; left: 50%;
  width: 60vmin; height: 60vmin;
  margin-left: -30vmin; margin-top: -30vmin;
  display: flex; flex-direction: column-reverse;
  align-items: center; justify-content: center;
  z-index: 3000;
  text-align: center;
}

#finalEffect img { width: 100%; height: auto; object-fit: contain; border-radius: 15px; margin-bottom: 15px; }
#finalEffect p { color: white; font-size: 4vmin; font-weight: bold; line-height: 1.3; margin-bottom: 10px; }

#board.game-over { pointer-events: none; opacity: 0.8; }

#nextPageBtn {
  margin-top: 20px;
  padding: 12px 24px;
  font-size: 1.2rem;
  background-color: #9333ea;
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  box-shadow: 0 0 15px #a855f7;
  transition: transform 0.2s;
}
#nextPageBtn:hover { transform: scale(1.05); }
</style>
</head>
<body>
<div id="title">as damas do nosso amor bb</div>
<div id="board"></div>
<button id="nextPageBtn" onclick="goToPage8()">Ir para P√°gina 8 ‚ûú</button>

<script>
const SIZE = 8;
const board = document.getElementById("board");
let state = Array.from({length: SIZE}, () => Array(SIZE).fill(null));
let cells = [];
let selected = null;
let turn = "player";
let gameOver = false;
let captureIndex = 0;
let effectsRunning = false;

// === Cria√ß√£o do tabuleiro ===
function createBoard(){
  board.innerHTML=""; cells=[];
  for(let y=0;y<SIZE;y++){
    for(let x=0;x<SIZE;x++){
      const cell=document.createElement("div");
      cell.className=(x+y)%2?"dark cell":"light cell";
      cell.dataset.x=x; cell.dataset.y=y;
      cell.onclick=()=>{if(!effectsRunning) onCellClick(x,y)};
      board.appendChild(cell);
      cells.push(cell);
    }
  }
}

// === Posicionamento inicial das pe√ßas ===
function placePieces(){
  for(let y=0;y<3;y++) for(let x=0;x<SIZE;x++) if((x+y)%2===1) state[y][x]={type:"ai",king:false};
  for(let y=5;y<SIZE;y++) for(let x=0;x<SIZE;x++) if((x+y)%2===1) state[y][x]={type:"player",king:false};
}

// === Renderiza o tabuleiro ===
function render(){
  cells.forEach(c=>c.innerHTML="");
  for(let y=0;y<SIZE;y++){
    for(let x=0;x<SIZE;x++){
      const p=state[y][x];
      if(p){
        const el=document.createElement("div");
        el.className=`piece ${p.type}${p.king?" king":""}`;
        cells[y*SIZE+x].appendChild(el);
      }
    }
  }
}

// === Valida√ß√£o de movimento ===
function isMoveValid(x1,y1,x2,y2){
  const piece=state[y1][x1];
  if(!piece || state[y2][x2]) return false;
  const dx=x2-x1, dy=y2-y1;
  if(!piece.king){
    if(piece.type==="player" && ![-1,-2].includes(dy)) return false;
    if(piece.type==="ai" && ![1,2].includes(dy)) return false;
    if(Math.abs(dx)===1 && Math.abs(dy)===1) return true;
    if(Math.abs(dx)===2 && Math.abs(dy)===2){
      const mx=(x1+x2)/2,my=(y1+y2)/2;
      return state[my][mx] && state[my][mx].type!==piece.type;
    }
    return false;
  }
  if(Math.abs(dx)!==Math.abs(dy)) return false;
  const stepX=dx>0?1:-1, stepY=dy>0?1:-1;
  let cx=x1+stepX, cy=y1+stepY, enemyFound=null;
  while(cx!==x2 && cy!==y2){
    const target=state[cy][cx];
    if(target){
      if(target.type===piece.type) return false;
      if(enemyFound) return false;
      enemyFound={x:cx,y:cy};
    }
    cx+=stepX; cy+=stepY;
  }
  return true;
}

// === Movimento principal ===
function movePiece(x1,y1,x2,y2,isPlayerMove=true){
  if(gameOver) return;
  const piece=state[y1][x1];
  let captured=false;
  let capturedPos = null;

  const dx=x2-x1, dy=y2-y1;
  if(Math.abs(dx)>1){
    const stepX=dx>0?1:-1, stepY=dy>0?1:-1;
    let cx=x1+stepX, cy=y1+stepY;
    while(cx!==x2 && cy!==y2){
      if(state[cy][cx] && state[cy][cx].type!==piece.type){
        captured=true;
        capturedPos={x:cx, y:cy};
        state[cy][cx]=null;
        break;
      }
      cx+=stepX; cy+=stepY;
    }
  }

  state[y2][x2]=piece;
  state[y1][x1]=null;
  render();
  clearHighlights();

  if(piece.type==="player" && y2===0 && !piece.king) piece.king=true;
  if(piece.type==="ai" && y2===SIZE-1 && !piece.king) piece.king=true;

  // Efeito do jogador
  if(isPlayerMove){
    if(capturedPos){
      showCaptureEffectWithPhoto(capturedPos.x, capturedPos.y, ()=>{
        if(!gameOver) { turn="ai"; setTimeout(()=>aiMove(), 300); }
      });
    } else if(piece.king) showOnlyText("Voc√™ sempre ser√° minha rainha dentro e fora do jogo");
  }

  // Captura extra
  if(captured && pieceHasCapture(x2,y2)){
    selected={x:x2,y:y2};
    highlightMoves(x2,y2);
    turn = piece.type;
    return;
  }

  selected=null;
  checkGameOver();

  if(!gameOver && !capturedPos) turn = piece.type==="player" ? "ai" : "player";
  if(turn==="ai" && !gameOver) setTimeout(()=>aiMove(), 300);
}

function pieceHasCapture(x,y){
  const piece=state[y][x]; if(!piece) return false;
  const dirs=piece.king?[-2,2]:piece.type==="player"?[-2]:[2];
  for(let dy of dirs) for(let dx of [-2,2]){
    const nx=x+dx,ny=y+dy;
    if(nx>=0 && nx<SIZE && ny>=0 && ny<SIZE && isMoveValid(x,y,nx,ny)) return true;
  }
  return false;
}

function highlightMoves(x,y){
  const piece=state[y][x]; if(!piece) return;
  const directions=piece.king?[-1,1]:piece.type==="player"?[-1]:[1];
  for(let dy of directions){
    for(let dx of [-1,1]){
      let nx=x+dx,ny=y+dy;
      while(nx>=0 && nx<SIZE && ny>=0 && ny<SIZE && !state[ny][nx]){
        cells[ny*SIZE+nx].classList.add("highlight");
        if(!piece.king) break;
        nx+=dx; ny+=dy;
      }
      let jumpX=x+dx*2,jumpY=y+dy*2;
      if(jumpX>=0 && jumpX<SIZE && jumpY>=0 && jumpY<SIZE && isMoveValid(x,y,jumpX,jumpY))
        cells[jumpY*SIZE+jumpX].classList.add("highlight");
    }
  }
}

function clearHighlights(){ cells.forEach(c=>c.classList.remove("highlight")); }

function onCellClick(x,y){
  if(turn!=="player" || gameOver || effectsRunning) return;
  clearHighlights();
  const piece=state[y][x];
  if(selected && isMoveValid(selected.x,selected.y,x,y)){
    movePiece(selected.x,selected.y,x,y,true); 
    return;
  }
  if(piece && piece.type==="player"){ selected={x,y}; highlightMoves(x,y); }
}

// === Movimento IA ===
function aiMove(){
  if(gameOver || turn!=="ai" || effectsRunning) return;
  let moves = [];
  for(let y=0;y<SIZE;y++){
    for(let x=0;x<SIZE;x++){
      const p=state[y][x];
      if(p && p.type==="ai"){
        for(let dx of [-1,1]){
          for(let dy of [1]){
            const nx=x+dx, ny=y+dy;
            if(nx>=0 && nx<SIZE && ny>=0 && ny<SIZE && !state[ny][nx])
              moves.push({x1:x,y1:y,x2:nx,y2:ny});
          }
        }
        for(let dx of [-2,2]){
          for(let dy of [2]){
            const nx=x+dx, ny=y+dy;
            if(nx>=0 && nx<SIZE && ny>=0 && ny<SIZE && isMoveValid(x,y,nx,ny))
              moves.push({x1:x,y1:y,x2:nx,y2:ny});
          }
        }
      }
    }
  }

  if(moves.length){
    const m = moves[Math.floor(Math.random()*moves.length)];
    movePiece(m.x1,m.y1,m.x2,m.y2,false);
  } else {
    gameOver = true;
    board.classList.add("game-over");
    showFinalEffect("Com toda a certeza, em todas as jogadas da vida, eu sempre escolherei voc√™, por inteira e completa, eu te amo üíú!");
  }
}

// === Efeitos visuais ===
function showOnlyText(text){
  effectsRunning = true;
  const effect = document.createElement("div");
  effect.className = "capture-effect";
  const p = document.createElement("p");
  p.textContent = text;
  effect.appendChild(p);
  document.body.appendChild(effect);
  setTimeout(()=>{
    effect.remove();
    effectsRunning = false;
  },3000);
}

function showCaptureEffectWithPhoto(x, y, callback=null){
  effectsRunning = true;
  const effect = document.createElement("div");
  effect.className = "capture-effect";

  const img = document.createElement("img");
  img.src = `damas/captura${captureIndex%12+1}.jpg`;

  const p = document.createElement("p");
  const captureTexts = [
    "Seu olhar me derrete.","Quero sentir voc√™ perto.","Cada curva sua me provoca.","N√£o consigo tirar voc√™ da cabe√ßa.",
    "Voc√™ √© desejo puro.","Sinto sua falta mesmo perto.","Quero explorar cada detalhe seu.","Seu corpo me chama.",
    "Voc√™ √© minha tenta√ß√£o favorita.","Cada toque seu me enlouquece.","Voc√™ √© linda demais para palavras.","Quero te ter s√≥ para mim."
  ];
  p.textContent = captureTexts[captureIndex%12];
  captureIndex++;

  effect.appendChild(p);
  effect.appendChild(img);
  document.body.appendChild(effect);

  setTimeout(()=>{
    effect.remove();
    effectsRunning = false;
    if(callback) callback();
  }, 3000);
}

// === Fim de jogo ===
function checkGameOver(){
  const aiPieces = state.flat().filter(p=>p && p.type==="ai").length;
  const playerPieces = state.flat().filter(p=>p && p.type==="player").length;
  const playerCanMove = hasAnyMove("player");
  const aiCanMove = hasAnyMove("ai");

  if(aiPieces===0 || playerPieces===0 || !playerCanMove || !aiCanMove){
    gameOver=true;
    board.classList.add("game-over");
    let msg = aiPieces===0 || !aiCanMove ? 
      "Com toda a certeza, em todas as jogadas da vida, eu sempre escolherei voc√™, por inteira e completa, eu te amo üíú!" 
      : "Que pena! A IA venceu!";
    board.style.transform="scale(1.2)";
    showFinalEffect(msg);
  }
}

function hasAnyMove(type){
  for(let y=0;y<SIZE;y++){
    for(let x=0;x<SIZE;x++){
      const p=state[y][x];
      if(p && p.type===type){
        for(let dx=-2;dx<=2;dx++){
          for(let dy=-2;dy<=2;dy++){
            const nx=x+dx,ny=y+dy;
            if(nx>=0 && nx<SIZE && ny>=0 && ny<SIZE && isMoveValid(x,y,nx,ny))
              return true;
          }
        }
      }
    }
  }
  return false;
}

function showFinalEffect(text){
  const effect=document.createElement("div");
  effect.id="finalEffect";
  const p=document.createElement("p"); p.textContent=text;
  const img=document.createElement("img"); img.src=`damas/final.jpg`;
  effect.appendChild(p); effect.appendChild(img);
  document.body.appendChild(effect);
}

// === Bot√£o p√°gina 8 ===
function goToPage8(){ window.location.href = "pagina8.html"; }

// === Inicializa ===
createBoard();
placePieces();
render();
</script>
</body>
  </html>
