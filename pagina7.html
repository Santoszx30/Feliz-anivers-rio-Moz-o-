<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>P√°gina 7 ‚ôüÔ∏èüíú</title>

<style>
*{
  box-sizing:border-box;
  user-select:none;
}

body{
  margin:0;
  min-height:100vh;
  font-family:Poppins, sans-serif;
  background:radial-gradient(circle at top,#4b1170,#12001a);
  color:white;
  overflow-x:hidden;
}

h1{
  text-align:center;
  margin:20px;
  font-size:1.4rem;
}

/* TABULEIRO */
#board{
  width:90vw;
  max-width:360px;
  aspect-ratio:1;
  margin:20px auto;
  display:grid;
  grid-template-columns:repeat(8,1fr);
  border:3px solid #a855f7;
  box-shadow:0 0 25px rgba(180,0,255,0.6);
}

/* CASAS */
.cell{
  width:100%;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
}

.dark{ background:#0b0016; }
.light{ background:#1b1026; }

/* PE√áAS */
.piece{
  width:80%;
  height:80%;
  border-radius:50%;
  touch-action:none;
}

.player{
  background:radial-gradient(circle,#d08cff,#7c2aff);
}

.enemy{
  background:radial-gradient(circle,#ff7a7a,#b30000);
}

.king{
  outline:3px solid gold;
}

/* MOVIMENTO */
.highlight{
  outline:3px dashed #9b4dff;
}
</style>
</head>

<body>

<h1>Jogo de Damas üíú</h1>

<div id="board"></div>

<script>
const board = document.getElementById("board");
let turn = "player";

/* UTILIDADES */
function idxToRC(i){
  return { r: Math.floor(i/8), c: i%8 };
}
function rcToIdx(r,c){
  if(r<0||r>7||c<0||c>7) return null;
  return r*8+c;
}

/* CRIAR TABULEIRO */
for(let r=0;r<8;r++){
  for(let c=0;c<8;c++){
    const cell=document.createElement("div");
    cell.className="cell "+((r+c)%2===1?"dark":"light");
    board.appendChild(cell);

    if(r<3 && (r+c)%2===1){
      cell.appendChild(createPiece("enemy"));
    }
    if(r>4 && (r+c)%2===1){
      cell.appendChild(createPiece("player"));
    }
  }
}

/* CRIAR PE√áA */
function createPiece(type){
  const p=document.createElement("div");
  p.className="piece "+type;
  if(type==="player") enableDrag(p);
  return p;
}

/* DRAG DO JOGADOR */
let selected=null;
let moves=[];

function enableDrag(piece){
  piece.addEventListener("pointerdown",()=>{
    if(turn!=="player") return;
    clearHighlights();
    selected=piece;
    moves=getMoves(piece);
    moves.forEach(i=>board.children[i].classList.add("highlight"));
  });
}

/* MOVIMENTOS V√ÅLIDOS */
function getMoves(piece){
  const idx=[...board.children].indexOf(piece.parentElement);
  const {r,c}=idxToRC(idx);
  const dir=-1;
  const res=[];
  [[dir,-1],[dir,1]].forEach(d=>{
    const t=rcToIdx(r+d[0],c+d[1]);
    if(t!==null && board.children[t].classList.contains("dark") && !board.children[t].firstChild){
      res.push(t);
    }
  });
  return res;
}

/* CLIQUE NO TABULEIRO */
board.addEventListener("click",e=>{
  if(!selected) return;
  const cell=e.target.closest(".cell");
  if(!cell) return;
  const idx=[...board.children].indexOf(cell);
  if(moves.includes(idx)){
    cell.appendChild(selected);
    promote(selected);
    clearHighlights();
    selected=null;
    turn="enemy";
    setTimeout(enemyMove,600);
  }
});

/* PROMO√á√ÉO */
function promote(piece){
  const idx=[...board.children].indexOf(piece.parentElement);
  const {r}=idxToRC(idx);
  if(piece.classList.contains("player") && r===0){
    piece.classList.add("king");
    alert("No cora√ß√£o de um homem sempre h√° uma menina, assim como num tabuleiro, um rei sempre precisa de sua rainha üíú");
  }
}

/* IA SIMPLES */
function enemyMove(){
  const enemies=[...document.querySelectorAll(".enemy")];
  for(let p of enemies){
    const idx=[...board.children].indexOf(p.parentElement);
    const {r,c}=idxToRC(idx);
    const targets=[
      rcToIdx(r+1,c+1),
      rcToIdx(r+1,c-1)
    ];
    for(let t of targets){
      if(t!==null && board.children[t].classList.contains("dark") && !board.children[t].firstChild){
        board.children[t].appendChild(p);
        turn="player";
        return;
      }
    }
  }
  turn="player";
}

/* LIMPAR */
function clearHighlights(){
  document.querySelectorAll(".highlight").forEach(c=>c.classList.remove("highlight"));
}
</script>

</body>
  </html>
