<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pinte o Amor</title>

<style>
*{
  box-sizing:border-box;
  margin:0;
  padding:0;
}

body{
  min-height:100vh;
  font-family:Arial, sans-serif;
  background: linear-gradient(135deg,#0b0016,#2a0050,#001b3a);
  display:flex;
  flex-direction:column;
  align-items:center;
  color:white;
}

h1{
  margin:20px 10px;
  text-align:center;
  font-size:1.4rem;
  color:#e9d5ff;
}

#contador{
  margin-bottom:10px;
  font-size:1rem;
  color:#c4b5fd;
}

#quadro{
  width:90vw;
  max-width:420px;
  height:65vh;
  max-height:600px;
  background:#2a2340;
  border-radius:18px;
  box-shadow:0 0 25px rgba(180,0,255,.5);
  display:flex;
  align-items:center;
  justify-content:center;
}

canvas{
  border-radius:14px;
  touch-action:none;
}

#final{
  display:none;
  text-align:center;
  margin:30px 20px;
}

#final h2{
  font-size:1.6rem;
  margin-bottom:15px;
  color:#f5d0fe;
}

#final p{
  font-size:1.1rem;
  line-height:1.6;
  margin-bottom:25px;
}

button{
  padding:15px 35px;
  font-size:1.1rem;
  border:none;
  border-radius:30px;
  cursor:pointer;
  background:linear-gradient(45deg,#9b4dff,#d08cff);
  color:white;
  box-shadow:0 0 18px rgba(180,0,255,.6);
}
</style>
</head>

<body>

<h1>Pinte a maneira de como eu enxergo sua beleza</h1>
<div id="contador">Quadro revelado: 0%</div>

<div id="quadro">
  <canvas id="canvas"></canvas>
</div>

<div id="final">
  <h2>Feliz aniversÃ¡rio minha nenÃ©m ðŸ’œ</h2>
  <p>
    VocÃª Ã© tÃ£o linda quanto a Lua,<br>
    brilha tanto quanto o Sol,<br>
    e ilumina minha vida de um jeito que sÃ³ vocÃª consegue.<br><br>
    Eu te amo.
  </p>
  <button onclick="window.location.href='pagina6.html'">
    Continuar ðŸ’œ
  </button>
</div>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const contador = document.getElementById("contador");
const finalBox = document.getElementById("final");

const img = new Image();
img.src = "coracao/amor1.jpg";

let painting = false;
let revealed = 0;
let totalArea = 0;

img.onload = () => {
  const scale = Math.min(
    canvas.parentElement.clientWidth / img.width,
    canvas.parentElement.clientHeight / img.height
  );

  canvas.width = img.width * scale;
  canvas.height = img.height * scale;

  totalArea = canvas.width * canvas.height;

  // desenha imagem base
  ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

  // camada de tinta
  ctx.globalCompositeOperation = "source-over";
  ctx.fillStyle = "#2a2340";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // modo pintura
  ctx.globalCompositeOperation = "destination-out";
};

function start(e){
  painting = true;
  paint(e);
}

function stop(){
  painting = false;
}

function paint(e){
  if(!painting) return;

  const rect = canvas.getBoundingClientRect();
  const touch = e.touches ? e.touches[0] : e;

  const x = touch.clientX - rect.left;
  const y = touch.clientY - rect.top;

  ctx.beginPath();
  ctx.arc(x,y,18,0,Math.PI*2);
  ctx.fill();

  revealed += 18*18;
  updateProgress();
}

function updateProgress(){
  const percent = Math.min(
    Math.floor((revealed / totalArea) * 100),
    100
  );

  contador.innerText = `Quadro revelado: ${percent}%`;

  if(percent >= 95){
    finalBox.style.display = "block";
  }
}

canvas.addEventListener("touchstart",start);
canvas.addEventListener("touchmove",paint);
canvas.addEventListener("touchend",stop);

canvas.addEventListener("mousedown",start);
canvas.addEventListener("mousemove",paint);
window.addEventListener("mouseup",stop);
</script>

</body>
</html>
